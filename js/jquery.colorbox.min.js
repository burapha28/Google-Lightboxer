
(function($){var colorbox='colorbox',hover='hover',TRUE=true,FALSE=false,cboxPublic,isIE=$.browser.msie&&!$.support.opacity,isIE6=isIE&&$.browser.version<7,cbox_open='cbox_open',cbox_load='cbox_load',cbox_complete='cbox_complete',cbox_cleanup='cbox_cleanup',cbox_closed='cbox_closed',$overlay,$cbox,$wrap,$content,$topBorder,$leftBorder,$rightBorder,$bottomBorder,$related,$window,$loaded,$loadingBay,$loadingOverlay,$title,$current,$slideshow,$next,$prev,$close,interfaceHeight,interfaceWidth,loadedHeight,loadedWidth,element,bookmark,index,settings,open,active,defaults={transition:"elastic",speed:350,width:FALSE,height:FALSE,innerWidth:FALSE,innerHeight:FALSE,initialWidth:"400",initialHeight:"400",maxWidth:FALSE,maxHeight:FALSE,minWidth:FALSE,minHeight:FALSE,scalePhotos:TRUE,scrolling:TRUE,inline:FALSE,html:FALSE,iframe:FALSE,photo:FALSE,href:FALSE,title:FALSE,rel:FALSE,opacity:0.9,preloading:TRUE,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:FALSE,overlayClose:TRUE,loop:TRUE,slideshow:FALSE,slideshowAuto:TRUE,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:FALSE,onLoad:FALSE,onComplete:FALSE,onCleanup:FALSE,onClosed:FALSE,escKey:TRUE,arrowKey:TRUE};function setSize(size,dimension){dimension=dimension==='x'?$window.width():$window.height();return(typeof size==='string')?Math.round((size.match(/%/)?(dimension/100)*parseInt(size,10):parseInt(size,10))):size;}
function isImage(url){url=$.isFunction(url)?url.call(element):url;return settings.photo||url.match(/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i);}
function process(){for(var i in settings){if($.isFunction(settings[i])&&i.substring(0,2)!=='on'){settings[i]=settings[i].call(element);}}
settings.rel=settings.rel||element.rel||'nofollow';settings.href=settings.href||$(element).attr('href');settings.title=settings.title||element.title;}
function launch(elem){element=elem;settings=$.extend({},$(element).data(colorbox));process();if(settings.rel!=='nofollow'){$related=$('.cboxElement').filter(function(){var relRelated=$(this).data(colorbox).rel||this.rel;return(relRelated===settings.rel);});index=$related.index(element);if(index<0){$related=$related.add(element);index=$related.length-1;}}else{$related=$(element);index=0;}
if(!open){open=TRUE;active=TRUE;bookmark=element;try{bookmark.blur();}catch(e){}
$.event.trigger(cbox_open);if(settings.onOpen){settings.onOpen.call(element);}
$overlay.css({"opacity":parseFloat(settings.opacity),"cursor":settings.overlayClose?"pointer":"auto"}).show();settings.w=setSize(settings.initialWidth,'x');settings.h=setSize(settings.initialHeight,'y');cboxPublic.position(0);if(isIE6){$window.bind('resize.cboxIE6 scroll.cboxIE6',function(){$overlay.css({width:$window.width(),height:$window.height(),top:$window.scrollTop(),left:$window.scrollLeft()});}).trigger("scroll.cboxIE6");}}
$current.add($prev).add($next).add($slideshow).add($title).hide();$close.html(settings.close).show();cboxPublic.slideshow();cboxPublic.load();}
cboxPublic=$.fn.colorbox=$.colorbox=function(options,callback){var $this=this;if($this.selector&&!$this.length){return $this;}
options=options||{};if(callback){options.onComplete=callback;}
if(!$this.length||$this.selector===undefined){$this=$('<a/>');options.open=TRUE;}
$this.each(function(){$(this).data(colorbox,$.extend({},$(this).data(colorbox)||defaults,options)).addClass("cboxElement");});if(options.open){launch($this[0]);}
return $this;};cboxPublic.init=function(){function $div(id){return $('<div id="cbox'+id+'"/>');}
$window=$(window);$cbox=$('<div id="colorbox"/>');$overlay=$div("Overlay").hide();$wrap=$div("Wrapper");$content=$div("Content").append($loaded=$div("LoadedContent").css({width:0,height:0}),$loadingOverlay=$div("LoadingOverlay").add($div("LoadingGraphic")),$title=$div("Title"),$current=$div("Current"),$next=$div("Next"),$prev=$div("Previous"),$slideshow=$div("Slideshow"),$close=$div("Close"));$wrap.append($('<div/>').append($div("TopLeft"),$topBorder=$div("TopCenter"),$div("TopRight")),$('<div/>').append($leftBorder=$div("MiddleLeft"),$content,$rightBorder=$div("MiddleRight")),$('<div/>').append($div("BottomLeft"),$bottomBorder=$div("BottomCenter"),$div("BottomRight"))).children().children().css({'float':'left'});$loadingBay=$("<div id='cboxLoadingBay' style='position:absolute; width:9999px;'/>");$('body').prepend($overlay,$cbox.append($wrap,$loadingBay));if(isIE){$cbox.addClass('cboxIE');if(isIE6){$overlay.css('position','absolute');}}
$content.children().hover(function(){$(this).addClass(hover);},function(){$(this).removeClass(hover);}).addClass(hover);interfaceHeight=$topBorder.height()+$bottomBorder.height()+$content.outerHeight(TRUE)-$content.height();interfaceWidth=$leftBorder.width()+$rightBorder.width()+$content.outerWidth(TRUE)-$content.width();loadedHeight=$loaded.outerHeight(TRUE);loadedWidth=$loaded.outerWidth(TRUE);$cbox.css({"padding-bottom":interfaceHeight,"padding-right":interfaceWidth}).hide();$next.click(cboxPublic.next);$prev.click(cboxPublic.prev);$close.click(cboxPublic.close);$content.children().removeClass(hover);$('.cboxElement').live('click',function(e){if((e.button!==0&&typeof e.button!=='undefined')||e.ctrlKey||e.shiftKey||e.altKey){return TRUE;}else{launch(this);return FALSE;}});$overlay.click(function(){if(settings.overlayClose){cboxPublic.close();}});$(document).bind("keydown",function(e){if(open&&settings.escKey&&e.keyCode===27){e.preventDefault();cboxPublic.close();}
if(open&&settings.arrowKey&&!active&&$related.length>1){if(e.keyCode===37&&(index>0||settings.loop)){e.preventDefault();$prev.click();}else if(e.keyCode===39&&(index<$related.length-1||settings.loop)){e.preventDefault();$next.click();}}});};cboxPublic.remove=function(){$cbox.add($overlay).remove();$('.cboxElement').removeData(colorbox).removeClass('cboxElement');};cboxPublic.position=function(speed,loadedCallback){var
animate_speed,posTop=Math.max($window.height()-settings.h-loadedHeight-interfaceHeight,0)/2+$window.scrollTop(),posLeft=Math.max($window.width()-settings.w-loadedWidth-interfaceWidth,0)/2+$window.scrollLeft();animate_speed=($cbox.width()===settings.w+loadedWidth&&$cbox.height()===settings.h+loadedHeight)?0:speed;$wrap[0].style.width=$wrap[0].style.height="9999px";function modalDimensions(that){$topBorder[0].style.width=$bottomBorder[0].style.width=$content[0].style.width=that.style.width;$loadingOverlay[0].style.height=$loadingOverlay[1].style.height=$content[0].style.height=$leftBorder[0].style.height=$rightBorder[0].style.height=that.style.height;}
$cbox.dequeue().animate({width:settings.w+loadedWidth,height:settings.h+loadedHeight,top:posTop,left:posLeft},{duration:animate_speed,complete:function(){modalDimensions(this);active=FALSE;$wrap[0].style.width=(settings.w+loadedWidth+interfaceWidth)+"px";$wrap[0].style.height=(settings.h+loadedHeight+interfaceHeight)+"px";if(loadedCallback){loadedCallback();}},step:function(){modalDimensions(this);}});};cboxPublic.resize=function(options){if(open){options=options||{};if(options.width){settings.w=setSize(options.width,'x')-loadedWidth-interfaceWidth;}
if(options.innerWidth){settings.w=setSize(options.innerWidth,'x');}
$loaded.css({width:settings.w});if(options.height){settings.h=setSize(options.height,'y')-loadedHeight-interfaceHeight;}
if(options.innerHeight){settings.h=setSize(options.innerHeight,'y');}
if(!options.innerHeight&&!options.height){var $child=$loaded.wrapInner("<div style='overflow:auto'></div>").children();settings.h=$child.height();$child.replaceWith($child.children());}
$loaded.css({height:settings.h});cboxPublic.position(settings.transition==="none"?0:settings.speed);}};cboxPublic.prep=function(object){if(!open){return;}
var photo,speed=settings.transition==="none"?0:settings.speed;$window.unbind('resize.cbox');$loaded.remove();$loaded=$('<div id="cboxLoadedContent"/>').html(object);function getWidth(){settings.w=settings.w||$loaded.width();if(settings.minWidth&&settings.w<settings.minWidth){settings.w=setSize(settings.minWidth,'x');}
settings.w=settings.mw&&settings.mw<settings.w?settings.mw:settings.w;return settings.w;}
function getHeight(){settings.h=settings.h||$loaded.height();if(settings.minHeight&&settings.h<settings.minHeight){settings.h=setSize(settings.minHeight,'y');}
settings.h=settings.mh&&settings.mh<settings.h?settings.mh:settings.h;return settings.h;}
$loaded.hide().appendTo($loadingBay).css({width:getWidth(),overflow:settings.scrolling?'auto':'hidden'}).css({height:getHeight()}).prependTo($content);$('#cboxPhoto').css({cssFloat:'none'});if(isIE6){$('select:not(#colorbox select)').filter(function(){return this.style.visibility!=='hidden';}).css({'visibility':'hidden'}).one(cbox_cleanup,function(){this.style.visibility='inherit';});}
function setPosition(s){var prev,prevSrc,next,nextSrc,total=$related.length,loop=settings.loop;cboxPublic.position(s,function(){function defilter(){if(isIE){$cbox[0].style.removeAttribute("filter");}}
if(!open){return;}
if(isIE){if(photo){$loaded.fadeIn(100);}}
if(settings.iframe){$("<iframe frameborder=0"+(settings.scrolling?"":" scrolling='no'")+(isIE?" allowtransparency='true'":'')+"/>").appendTo($loaded).attr({src:settings.href,id:'cboxIframe',name:new Date().getTime()});}
$loaded.show();$title.show().html(settings.title);if(total>1){$current.html(settings.current.replace(/\{current\}/,index+1).replace(/\{total\}/,total)).show();$next[(loop||index<total-1)?"show":"hide"]().html(settings.next);$prev[(loop||index>0)?"show":"hide"]().html(settings.previous);prev=index>0?$related[index-1]:$related[total-1];next=index<total-1?$related[index+1]:$related[0];if(settings.slideshow){$slideshow.show();if(index===total-1&&!loop&&$cbox.is('.cboxSlideshow_on')){$slideshow.click();}}
if(settings.preloading){nextSrc=$(next).data(colorbox).href||next.href;prevSrc=$(prev).data(colorbox).href||prev.href;if(isImage(nextSrc)){$('<img/>')[0].src=nextSrc;}
if(isImage(prevSrc)){$('<img/>')[0].src=prevSrc;}}}
$loadingOverlay.hide();if(settings.transition==='fade'){$cbox.fadeTo(speed,1,function(){defilter();});}else{defilter();}
$window.bind('resize.cbox',function(){cboxPublic.position(0);});$.event.trigger(cbox_complete);if(settings.onComplete){settings.onComplete.call(element);}});}
if(settings.transition==='fade'){$cbox.fadeTo(speed,0,function(){setPosition(0);});}else{setPosition(speed);}};cboxPublic.load=function(){var href,img,setResize,prep=cboxPublic.prep;active=FALSE;element=$related[index];settings=$.extend({},$(element).data(colorbox));process();$.event.trigger(cbox_load);if(settings.onLoad){settings.onLoad.call(element);}
settings.h=settings.height?setSize(settings.height,'y')-loadedHeight-interfaceHeight:settings.innerHeight?setSize(settings.innerHeight,'y'):FALSE;settings.w=settings.width?setSize(settings.width,'x')-loadedWidth-interfaceWidth:settings.innerWidth?setSize(settings.innerWidth,'x'):FALSE;settings.mw=settings.w;settings.mh=settings.h;if(settings.maxWidth){settings.mw=setSize(settings.maxWidth,'x')-loadedWidth-interfaceWidth;settings.mw=settings.w&&settings.w<settings.mw?settings.w:settings.mw;}
if(settings.maxHeight){settings.mh=setSize(settings.maxHeight,'y')-loadedHeight-interfaceHeight;settings.mh=settings.h&&settings.h<settings.mh?settings.h:settings.mh;}
href=settings.href;$loadingOverlay.show();if(settings.inline){$('<div id="cboxInlineTemp"/>').hide().insertBefore($(href)[0]).bind(cbox_load+' '+cbox_cleanup,function(){$(this).replaceWith($loaded.children());});prep($(href));}else if(settings.iframe){prep(" ");}else if(settings.html){prep(settings.html);}else if(isImage(href)){img=new Image();img.onload=function(){var percent;img.onload=null;img.id='cboxPhoto';$(img).css({margin:'auto',border:'none',display:'block',cssFloat:'left'});if(settings.scalePhotos){setResize=function(){img.height-=img.height*percent;img.width-=img.width*percent;};if(settings.mw&&img.width>settings.mw){percent=(img.width-settings.mw)/img.width;setResize();}
if(settings.mh&&img.height>settings.mh){percent=(img.height-settings.mh)/img.height;setResize();}}
if(settings.h||settings.minHeight){img.style.marginTop=Math.max((settings.h||settings.minHeight)-img.height,0)/2+'px';}
prep(img);if($related.length>1){$(img).css({cursor:'pointer'}).click(cboxPublic.next);}
if(isIE){img.style.msInterpolationMode='bicubic';}};img.src=href;}else{$('<div>Request unsuccessful.</div>').appendTo($loadingBay).load(href,function(data,textStatus){prep(this);});}};cboxPublic.next=function(){if(!active){index=index<$related.length-1?index+1:0;cboxPublic.load();}};cboxPublic.prev=function(){if(!active){index=index>0?index-1:$related.length-1;cboxPublic.load();}};cboxPublic.slideshow=function(){var stop,timeOut,className='cboxSlideshow_';$slideshow.bind(cbox_closed,function(){$slideshow.unbind();clearTimeout(timeOut);$cbox.removeClass(className+"off "+className+"on");});function start(){$slideshow.text(settings.slideshowStop).bind(cbox_complete,function(){timeOut=setTimeout(cboxPublic.next,settings.slideshowSpeed);}).bind(cbox_load,function(){clearTimeout(timeOut);}).one("click",function(){stop();});$cbox.removeClass(className+"off").addClass(className+"on");}
stop=function(){clearTimeout(timeOut);$slideshow.text(settings.slideshowStart).unbind(cbox_complete+' '+cbox_load).one("click",function(){start();timeOut=setTimeout(cboxPublic.next,settings.slideshowSpeed);});$cbox.removeClass(className+"on").addClass(className+"off");};if(settings.slideshow&&$related.length>1){if(settings.slideshowAuto){start();}else{stop();}}};cboxPublic.close=function(){if(open){open=FALSE;$.event.trigger(cbox_cleanup);if(settings.onCleanup){settings.onCleanup.call(element);}
$window.unbind('.cbox .cboxIE6');$cbox.add($overlay).stop().fadeTo('fast',0,function(){$('#colorbox iframe').attr('src','about:blank');$loaded.remove();$cbox.add($overlay).css({'opacity':1,cursor:'auto'}).hide();try{bookmark.focus();}catch(e){}
setTimeout(function(){$.event.trigger(cbox_closed);if(settings.onClosed){settings.onClosed.call(element);}},1);});}};cboxPublic.element=function(){return $(element);};cboxPublic.settings=defaults;$(cboxPublic.init);}(jQuery));